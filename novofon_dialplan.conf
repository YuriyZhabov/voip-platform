[from-internal-custom]
exten => 8888,1,NoOp(Test call to Novofon verification)
same => n,Dial(PJSIP/8888@0053248,30)
same => n,Hangup()

[from-novofon]
; Обработка входящих звонков на конкретный номер
exten => 79952227978,1,NoOp(Incoming call from Novofon to main number: ${CALLERID(all)})
same => n,Answer()
same => n,Wait(1)
same => n,Set(CHANNEL(language)=ru)
same => n,Playback(hello-world)
same => n,Stasis(livekit-agent,${CALLERID(num)},${EXTEN})
same => n,Hangup()

; Обработка входящих звонков с префиксом +7
exten => +79952227978,1,Goto(from-novofon,79952227978,1)

; Обработка любых входящих звонков с Novofon (шаблон для всех номеров)
exten => _X.,1,NoOp(Incoming call from Novofon to any number: ${CALLERID(all)})
same => n,Answer()
same => n,Wait(1)
same => n,Set(CHANNEL(language)=ru)
same => n,Playback(hello-world)
same => n,Stasis(livekit-agent,${CALLERID(num)},${EXTEN})
same => n,Hangup()

; Обработка входящих звонков без номера (анонимные)
exten => s,1,NoOp(Anonymous call from Novofon)
same => n,Answer()
same => n,Wait(1)
same => n,Set(CHANNEL(language)=ru)
same => n,Playback(hello-world)
same => n,Stasis(livekit-agent,anonymous,unknown)
same => n,Hangup()