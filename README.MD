# VoIP Platform —Å AI Agent

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è VoIP –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞ –±–∞–∑–µ Asterisk 22 —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π AI –∞–≥–µ–Ω—Ç–æ–≤ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å LiveKit Cloud.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/YuriyZhabov/voip-platform.git
cd voip-platform
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –ø—Ä–∏–º–µ—Ä–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª, –¥–æ–±–∞–≤–∏–≤ –≤–∞—à–∏ API –∫–ª—é—á–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
nano .env
```

### 3. –ó–∞–ø—É—Å–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f
```

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–ª–∞—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É LiveKit —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

- **Novofon SIP Provider** - –≤—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ SIP-—Ç—Ä–∞–Ω–∫
- **Asterisk 22 PBX** - –ª–æ–∫–∞–ª—å–Ω–∞—è –ê–¢–° —Å PJSIP –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–≤–æ–Ω–∫–æ–≤
- **LiveKit Cloud** - –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è WebRTC –∏ –º–µ–¥–∏–∞-–æ–±—Ä–∞–±–æ—Ç–∫–∏
- **AI Agent** - –ª–æ–∫–∞–ª—å–Ω—ã–π –ò–ò-–∞–≥–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π OpenAI, Deepgram, Cartesia
- **Redis** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
voip-platform/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ .env.example               # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ asterisk/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Asterisk 22
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pjsip.conf       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PJSIP
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ extensions.conf   # –î–∏–∞–ª–ø–ª–∞–Ω
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules.conf     # –ú–æ–¥—É–ª–∏ Asterisk
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ari.conf         # Asterisk REST Interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stasis.conf      # Stasis –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http.conf        # HTTP —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ manager.conf     # AMI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.conf      # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.conf    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cdr.conf         # Call Detail Records
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cel.conf         # Channel Event Logging
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ features.conf    # –§—É–Ω–∫—Ü–∏–∏ –∑–≤–æ–Ω–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ agent/               # AI Agent
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agent.py         # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tools.py         # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile       # Docker –æ–±—Ä–∞–∑ –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ redis/
‚îÇ       ‚îî‚îÄ‚îÄ redis.conf       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ asterisk/
‚îÇ       ‚îú‚îÄ‚îÄ Dockerfile       # Docker –æ–±—Ä–∞–∑ Asterisk 22
‚îÇ       ‚îî‚îÄ‚îÄ entrypoint.sh    # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Å XML –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ init-asterisk.sh     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Asterisk
‚îÇ   ‚îú‚îÄ‚îÄ init-agent.sh        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ backup.sh            # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ docs/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ asterisk.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Asterisk
    ‚îú‚îÄ‚îÄ asterisk_22_upgrade.md
    ‚îú‚îÄ‚îÄ asterisk_stasis.md
    ‚îú‚îÄ‚îÄ res_ari.md
    ‚îú‚îÄ‚îÄ res_statsd.md
    ‚îî‚îÄ‚îÄ pjsip.md
```

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Asterisk 22
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WebRTC
- PJSIP –¥–ª—è SIP –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- ARI (Asterisk REST Interface) –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- Stasis –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–≤–æ–Ω–∫–æ–≤
- –ü–æ–ª–Ω–∞—è XML –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π

### AI Agent
- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ LiveKit Agents Framework
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI GPT-4o-mini –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —è–∑—ã–∫–∞
- Deepgram –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ (STT)
- Cartesia –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏ (TTS)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- Health check endpoints

### Redis
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–∞
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```bash
# LiveKit Cloud –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
LIVEKIT_URL=wss://your-livekit-instance.livekit.cloud
LIVEKIT_API_KEY=your_api_key
LIVEKIT_API_SECRET=your_api_secret
LIVEKIT_DOMAIN=your-domain.com
LIVEKIT_PUBLIC_IP=your.public.ip

# SIP –ø—Ä–æ–≤–∞–π–¥–µ—Ä (Novofon)
NOVOFON_NUMBER=+7XXXXXXXXXX
NOVOFON_SIP_SERVER=sip.novofon.ru
NOVOFON_USERNAME=your_username
NOVOFON_PASSWORD=your_password

# AI —Å–µ—Ä–≤–∏—Å—ã
OPENAI_API_KEY=sk-proj-your_openai_key
DEEPGRAM_API_KEY=your_deepgram_key
CARTESIA_API_KEY=sk_car_your_cartesia_key

# Asterisk
ASTERISK_USER=asterisk
ASTERISK_MANAGER_SECRET=your_manager_secret
```

### Docker Compose —Å–µ—Ä–≤–∏—Å—ã

- **asterisk** - Asterisk 22 PBX —Å network_mode: host
- **livekit-agent** - AI –∞–≥–µ–Ω—Ç —Å health check
- **redis** - Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ó–∞–ø—É—Å–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f asterisk
docker-compose logs -f livekit-agent
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```bash
# Health check –∞–≥–µ–Ω—Ç–∞
curl http://localhost:8081/health

# –°—Ç–∞—Ç—É—Å Asterisk
docker exec asterisk-pbx asterisk -rx "core show version"

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è SIP
docker exec asterisk-pbx asterisk -rx "pjsip show registrations"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis
docker exec redis-cache redis-cli ping
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart livekit-agent

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
docker-compose build --no-cache
docker-compose up -d
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏
- Asterisk: `/var/log/asterisk/`
- Agent: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–≥–∏ + `/logs/agent.log`
- Redis: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–≥–∏

### Health Check endpoints
- Agent: `http://localhost:8081/health`
- Agent status: `http://localhost:8081/status`

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# Asterisk CLI
docker exec -it asterisk-pbx asterisk -r

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PJSIP endpoints
docker exec asterisk-pbx asterisk -rx "pjsip show endpoints"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
docker exec asterisk-pbx asterisk -rx "core show channels"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
docker exec -it livekit-agent python agent.py console
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º —á–µ—Ä–µ–∑ firewall
3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ API –∫–ª—é—á–∏
4. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∫–≤–æ—Ç
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS/WSS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### –§–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `.env` - –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git, —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã
- `configs/asterisk/security.conf` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Asterisk
- `configs/asterisk/manager.conf` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è AMI –¥–æ—Å—Ç—É–ø–∞

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
- [Asterisk 22 Setup](asterisk.md)
- [Asterisk 22 Upgrade Guide](asterisk_22_upgrade.md)
- [Stasis Applications](asterisk_stasis.md)
- [ARI Integration](res_ari.md)
- [StatsD Monitoring](res_statsd.md)
- [PJSIP Configuration](pjsip.md)
- [Quick Start Guide](QUICKSTART.md)

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ health check endpoints –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª LICENSE –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ API –∫–ª—é—á–∏ –∏ –ø–∞—Ä–æ–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ –≤–∞—à–µ–π —Å—Ä–µ–¥–µ.