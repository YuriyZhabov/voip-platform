# Ð”Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½ Ð´Ð»Ñ VoIP ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹

Ð­Ñ‚Ð¾Ñ‚ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð° Ð´Ð»Ñ Asterisk, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÑÐ±Ð¾Ñ€ÐºÐ¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.

## ðŸ”„ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°**: ÐŸÑ€Ð¸ Ð¿ÐµÑ€ÐµÑÐ±Ð¾Ñ€ÐºÐµ FreePBX Ñ‚ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°.

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ**: Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ `start-system.sh` Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½ Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð° `extensions_dialplan.conf`.

## ðŸ“ Ð¤Ð°Ð¹Ð»Ñ‹

### extensions_dialplan.conf
ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ„Ð°Ð¹Ð» Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼ `start-system.sh` Ð¿Ñ€Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.

**ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° Ð²Ñ‹Ð½ÐµÑÐµÐ½Ð¸Ñ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»:**
- âœ… Ð›ÐµÐ³ÐºÐ¾ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð±ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°
- âœ… Ð’ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð² Git
- âœ… ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÑÐ±Ð¾Ñ€ÐºÐ¸
- âœ… Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ð²ÐµÑ€ÑÐ¸Ð¹ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°

## ðŸ“‹ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°

### [from-novofon]
ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð·Ð²Ð¾Ð½ÐºÐ¾Ð² Ð¾Ñ‚ Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ð° Novofon:
- `79952227978` - Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð½Ð¾Ð¼ÐµÑ€ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
- Ð—Ð²Ð¾Ð½ÐºÐ¸ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ Ð² LiveKit Ð°Ð³ÐµÐ½Ñ‚ Ñ‡ÐµÑ€ÐµÐ· ARI Stasis
- Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° hangup handler Ð´Ð»Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ

### [hangup-handler]
ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð² Ð´Ð»Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð².

### [from-internal-custom]
ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð´Ð»Ñ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ñ… Ð¸ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²:
- `9999` - Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€ Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸ÐµÐ¼ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ
- `8888` - Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€ Ñ ÑÑ…Ð¾-Ñ‚ÐµÑÑ‚Ð¾Ð¼ (Ð½Ð¾Ð²Ñ‹Ð¹)

## âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°

### Ð¡Ð¿Ð¾ÑÐ¾Ð± 1: Ð§ÐµÑ€ÐµÐ· Ñ„Ð°Ð¹Ð» (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)
```bash
# ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°
nano configs/dialplan/extensions_dialplan.conf

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
./scripts/start-system.sh
```

### Ð¡Ð¿Ð¾ÑÐ¾Ð± 2: ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°
```bash
# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð² ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€
docker cp configs/dialplan/extensions_dialplan.conf freepbx-server:/tmp/

# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ðº ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¼Ñƒ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ñƒ
docker exec freepbx-server bash -c 'cat /tmp/extensions_dialplan.conf >> /etc/asterisk/extensions_custom.conf'

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½
docker exec freepbx-server asterisk -rx "dialplan reload"
```

## ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ from-novofon
docker exec freepbx-server asterisk -rx "dialplan show from-novofon"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð½Ð¾Ð¼ÐµÑ€Ð°
docker exec freepbx-server asterisk -rx "dialplan show from-internal-custom"

# ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÐµÑÑŒ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½
docker exec freepbx-server asterisk -rx "dialplan show"
```

### Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°
```bash
# Ð¢ÐµÑÑ‚ Ñ‡ÐµÑ€ÐµÐ· ÑÐºÑ€Ð¸Ð¿Ñ‚ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)
./scripts/test_system.sh

# Ð ÑƒÑ‡Ð½Ð¾Ð¹ Ñ‚ÐµÑÑ‚ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÐµÐ³Ð¾ Ð½Ð¾Ð¼ÐµÑ€Ð°
docker exec freepbx-server asterisk -rx "channel originate Local/9999@from-internal-custom application Wait 5"

# Ð¢ÐµÑÑ‚ ÑÑ…Ð¾ Ð½Ð¾Ð¼ÐµÑ€Ð°
docker exec freepbx-server asterisk -rx "channel originate Local/8888@from-internal-custom application Wait 10"
```

## âž• Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð²

### Ð¨Ð°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð·Ð²Ð¾Ð½ÐºÐ¾Ð² (LiveKit)
```ini
exten => ÐÐžÐ’Ð«Ð™_ÐÐžÐœÐ•Ð ,1,NoOp(Incoming call to ${EXTEN})
 same => n,Set(CHANNEL(hangup_handler_push)=hangup-handler,s,1)
 same => n,Answer()
 same => n,Wait(1)
 same => n,Stasis(livekit-agent,incoming,${CALLERID(num)})
 same => n,Hangup()
```

### Ð¨Ð°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð²
```ini
exten => Ð¢Ð•Ð¡Ð¢_ÐÐžÐœÐ•Ð ,1,NoOp(Test call to ${EXTEN})
 same => n,Answer()
 same => n,Playback(demo-congrats)
 same => n,Hangup()
```

### Ð¨Ð°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ ÑÑ…Ð¾-Ñ‚ÐµÑÑ‚Ð°
```ini
exten => Ð­Ð¥Ðž_ÐÐžÐœÐ•Ð ,1,NoOp(Echo test call)
 same => n,Answer()
 same => n,Echo()
 same => n,Hangup()
```

## ðŸ”§ Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

### Ð£ÑÐ»Ð¾Ð²Ð½Ð°Ñ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
```ini
exten => 79952227978,1,NoOp(Time-based routing)
 same => n,GotoIfTime(09:00-18:00,mon-fri,*,*?working_hours,s,1)
 same => n,Goto(after_hours,s,1)

[working_hours]
exten => s,1,Stasis(livekit-agent,business,${CALLERID(num)})

[after_hours]
exten => s,1,Stasis(livekit-agent,after_hours,${CALLERID(num)})
```

### ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð½Ð¾Ð¼ÐµÑ€Ñƒ Ð·Ð²Ð¾Ð½ÑÑ‰ÐµÐ³Ð¾
```ini
exten => 79952227978,1,NoOp(Caller-based routing)
 same => n,GotoIf($["${CALLERID(num):0:2}" = "+7"]?russian_caller,s,1)
 same => n,Stasis(livekit-agent,international,${CALLERID(num)})

[russian_caller]
exten => s,1,Stasis(livekit-agent,russian,${CALLERID(num)})
```

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð’ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
```bash
# Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ð°
docker exec freepbx-server asterisk -rx "core set verbose 5"
docker exec freepbx-server asterisk -rx "core set debug 3"

# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð»Ð¾Ð³Ð¾Ð² Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
docker exec freepbx-server asterisk -rx "core show channels verbose"
```

### ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸
```bash
# Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¿Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð°Ð¼
docker exec freepbx-server asterisk -rx "dialplan show counters"

# ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ ÐºÐ°Ð½Ð°Ð»Ñ‹
docker exec freepbx-server asterisk -rx "core show channels concise"
```

## ðŸš¨ Ð£ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ð¾Ðº

### Ð”Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½ Ð½Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ
1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ Ñ„Ð°Ð¹Ð»Ð°
2. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ñ„Ð°Ð¹Ð» ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ Asterisk

### Ð—Ð²Ð¾Ð½ÐºÐ¸ Ð½Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´ÑÑ‚ Ñ‡ÐµÑ€ÐµÐ· Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½
1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… SIP Ñ‚Ñ€Ð°Ð½ÐºÐ°
2. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ð½Ð¾Ð¼ÐµÑ€ Ñ‚Ð¾Ñ‡Ð½Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÐµÑ‚
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ‹ (priority) Ð² Ð´Ð¸Ð°Ð»Ð¿Ð»Ð°Ð½Ðµ

### ARI Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð·Ð²Ð¾Ð½ÐºÐ¸
1. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ ARI ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½
2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ: `asterisk -rx "ari show apps"`
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ LiveKit Ð°Ð³ÐµÐ½Ñ‚Ð°

## ðŸ“ ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ

### ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ IVR
```ini
[ivr-main]
exten => s,1,Answer()
 same => n,Background(welcome)
 same => n,WaitExten(10)

exten => 1,1,Stasis(livekit-agent,sales,${CALLERID(num)})
exten => 2,1,Stasis(livekit-agent,support,${CALLERID(num)})
exten => t,1,Goto(s,1)
exten => i,1,Playback(invalid)
 same => n,Goto(s,1)
```

### Ð—Ð°Ð¿Ð¸ÑÑŒ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð²
```ini
exten => 79952227978,1,NoOp(Recording call)
 same => n,Set(FILENAME=call-${STRFTIME(${EPOCH},,%Y%m%d-%H%M%S)}-${CALLERID(num)})
 same => n,MixMonitor(/var/spool/asterisk/monitor/${FILENAME}.wav)
 same => n,Stasis(livekit-agent,recorded,${CALLERID(num)})
```